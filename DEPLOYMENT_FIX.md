# Deployment Fix Instructions

This document outlines the steps required to fix the "white screen" issue and missing styles/scripts on the VPS. The issue is caused by incorrect file permissions and strict Content Security Policy (CSP) settings in Nginx.

## 1. Fix File Permissions

The web server (likely `www-data`) needs permission to read the built assets. Currently, they are owned by `root`.

Run the following command on your VPS:

```bash
sudo chown -R www-data:www-data /var/www/otorrinonet/public/build
```

## 2. Configure Nginx CSP

The current Nginx configuration is blocking the loading of CSS and JavaScript files generated by Vite. You need to update your Nginx site configuration to allow these assets.

1. Open your Nginx configuration file (e.g., `/etc/nginx/sites-available/otorrinonet` or `/etc/nginx/sites-enabled/default`).
2. Add or update the `add_header Content-Security-Policy` directive inside the `server` block.

### Recommended Configuration

Use the following configuration to allow scripts and styles from the same origin ('self').

```nginx
server {
    # ... existing configuration ...

    root /var/www/otorrinonet/public;
    index index.php index.html index.htm;

    # Basic CSP to allow Vite assets
    # 'self' allows resources from the same domain.
    # 'unsafe-inline' is often needed for styles injected by JS or some Tailwind setups,
    # but strictly speaking, a production build of Vite + Tailwind should work with just 'self' for styles if main.css is a file.
    # If you still see errors, you can add 'unsafe-inline' to style-src.

    add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self';";

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    # ... PHP handling ...
}
```

**Note on `unsafe-eval`:** Vite (especially in development or some legacy modes) might use eval. If you are running a production build (`npm run build`), you strictly shouldn't need `'unsafe-eval'`, but if you encounter issues, you can temporarily allow it as shown above. Ideally, remove `'unsafe-eval'` if everything works without it.

3. Test and reload Nginx:

```bash
sudo nginx -t
sudo systemctl reload nginx
```

## 3. Verify

1. Clear your browser cache.
2. Reload the page.
3. The styles should now load correctly.
